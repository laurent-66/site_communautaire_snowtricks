
{% extends 'base.html.twig' %}

{% block title %}Bienvenue{% endblock %}

{% block body %}
    <div class="imageHero px-0">
        <h1>SNOWTRICKS</h1>
        <div class="accroche"><h2>Devient un pro du snow !</h2></div>
        <p><strong>Bienvenue sur notre site collaboratif.</strong></p>
        <div class="arrow-down"><a href="#Tricks-list"><i class="fas fa-arrow-down fa-3x" style="color:white;"></i></a></div> 
    </div> 
    <div class="container-fluid">
        <h2 class="mt-2 mb-4 text-center" id="Tricks-list">Liste des figures</h2>

        <div class="row mx-5" id="container-figures">

            {% for figure in figures %}

                <div class="col-sm-12 col-md-12 col-lg-3">
                    <div class="card bg-light border mb-3 rounded-3">
                        <img src="{{figure.coverImage}}" alt="Image de la figure"
                        style="height: 200px; width:100%; display: block;">
                        <div class="card-body">
                            <div class="row mx-0 px-0">
                                <div class="col-8 mx-0 px-0">
                                    <h5 class="card-title">{{figure.name}}</h5>
                                </div>
                                <div class="col-4 mx-0 px-0">
                                    <a href="#" class="btn btn-info"><i class="fas fa-edit"></i></a>
                                    <a href="#" class="btn btn-danger"><i class="fas fa-trash-alt"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            {% endfor %}

            {# {% include 'partials/list_figures.html.twig' with {'figures': figures} %} #}

        </div>

        <div style="display:flex; justify-content:center;">
            <button class="btn btn-primary my-3" id="load-more" data-total-page="{{ pageTotal }}" data-next-page="{{ page + 1 }}" data-figure-ajax="{{ path('get_figure_ajax')}}">Charger plus</button>
        </div>
    </div>

    {% block javascripts %}

    <script language="javascript">
        $('#load-more').on('click', function(e) {
            const totalPage = $('#load-more').data('total-page');
            const nextPage = $('#load-more').data('next-page');
            const urlToCallAjax = $('#load-more').data('figure-ajax');
            fetch(urlToCallAjax + '?page=' + nextPage) //https://URL/ajax/figures?page=
            .then((resp) => resp.json())
            .then(data => {
                if((nextPage +1) === totalPage) {
                //TODO DÃ©sactiver le bouton
                $('#load-more').prop('disabled', true);
                }
                 $('#load-more').data('next-page', nextPage + 1);
                $('#container-figures').append(data.html);
            })
        })
    </script>

    {% endblock %}

{% endblock %}
